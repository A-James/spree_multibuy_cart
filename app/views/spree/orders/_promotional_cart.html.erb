<div data-hook="outside_cart_form">
  <%= form_for @order, :url => update_cart_path, method: :patch, :html => {:id => 'update-cart'} do |order_form| %>
    <div data-hook="inside_cart_form">

      <div data-hook="cart_items">

          <% @products_and_totals.each do |product_and_total| %>
            <% product = product_and_total[:product] %>
            <div id="product_<%= product.id %>" class="product-select well" data-hook="products_list_item" itemscope itemtype="http://schema.org/Product">
              <%= radio_button_tag :product, product.master.id, product_and_total[:selected] %>
              <%= label_tag "product_#{product.master.id}", truncate(product.name, :length => 50), :class => 'info', :itemprop => "name", :title => product.name %>

              <span><%= product.description %></span>
              <span><%= product.property("totalNumber") %> <%= Spree.t(:in_bundle) %> (<%= Spree.t(:just_each, :price => product_and_total[:per_item_price]) %>)</span> 

              <h2 class="price selling pull-right" itemprop="price"><%= display_price(product) %></h2>

              <div class="product-image">
                <%= small_image(product, :itemprop => "image") %>
              </div>
              
              <span class="hidden" id="product-order-total"><%= product_and_total[:order_total].to_html %></span>
            </div>
          <% end %>
          <% reset_cycle("classes") %>

        <% if @order.line_item_adjustments.any? %>
          <%= render :partial => 'form', :locals => { :order_form => order_form } %>
        <% end %>
      </div>

      <div id="subtotal" data-hook class="well col-md-12 text-right">
        <%= Spree.t(:subtotal) %>: <span class="lead text-primary order-total"><%= @order_total.to_html %> 
      </div>

      <div class="links col-md-6 navbar-form pull-right text-right" data-hook="cart_buttons">
        <div class="form-group">
        <%= order_form.text_field :coupon_code, :size => 10, :placeholder => Spree.t(:coupon_code), class: "form-control form-control-inline" %></div>
        <%= button_tag :class => 'btn btn-primary', :id => 'update-button' do %>
          <%= Spree.t(:update) %>
        <% end %>
        <%= button_tag :class => 'btn btn-lg btn-success', :id => 'checkout-link', :name => 'checkout' do %>
          <span class="glyphicon glyphicon-lock"></span> <%= Spree.t(:checkout) %>
        <% end %>
        <br/>Shipped Fast Today!
      </div>
    </div>
  <% end %>
</div>

<div id="empty-cart" class="col-md-6 pull-left" data-hook>
  <%= form_tag empty_cart_path, :method => :put do %>
    <p id="clear_cart_link" data-hook>
      <%= submit_tag Spree.t(:empty_cart), :class => 'btn btn-default' %>
      <%= Spree.t(:or) %>
      <%= link_to Spree.t(:continue_shopping), products_path, :class => 'continue' %>
    </p>
  <% end %>
</div>